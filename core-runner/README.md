# JALM Core Runner

–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —è–¥—Ä–æ –¥–ª—è JALM Full Stack - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è JALM-–∫–æ–Ω—Ñ–∏–≥–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π 6 —Å–ª–æ—ë–≤ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:
```
core-runner/
‚îú‚îÄ‚îÄ kernel/               # –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ raw_atomics.csv   # –ê—Ç–æ–º—ã –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ layers.json       # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Å–ª–æ—è–º
‚îÇ   ‚îú‚îÄ‚îÄ step_cards/       # –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —à–∞–≥–∏
‚îÇ   ‚îî‚îÄ‚îÄ src/main.py       # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ —è–¥—Ä–∞
‚îú‚îÄ‚îÄ cfg/                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∞–Ω—Ç–∞–π–º–∞
‚îú‚îÄ‚îÄ scheduler/            # Cron / event loop
‚îú‚îÄ‚îÄ registry-proxy/       # Pull tula –Ω–∞ –ª–µ—Ç—É
‚îú‚îÄ‚îÄ api/                  # OpenAPI —Å–µ—Ä–≤–µ—Ä —è–¥—Ä–∞
‚îú‚îÄ‚îÄ state-store/          # Inmem KV + PostgreSQL
‚îú‚îÄ‚îÄ scripts/              # –°–∫—Ä–∏–ø—Ç—ã —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ dist/                 # –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ Dockerfile           # –ú–Ω–æ–≥–æ—Å—Ç–∞–¥–∏–π–Ω–∞—è —Å–±–æ—Ä–∫–∞
‚îú‚îÄ‚îÄ Makefile             # –ö–æ–º–∞–Ω–¥—ã —Å–±–æ—Ä–∫–∏
‚îî‚îÄ‚îÄ requirements.txt     # Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

### 6 —Å–ª–æ—ë–≤ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:
- **io-http**: HTTP-–∑–∞–ø—Ä–æ—Å—ã –∏ API-–≤—ã–∑–æ–≤—ã
- **io-db**: –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
- **io-file**: –§–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **compute-script**: –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **render-html**: –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **notify-mq**: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- Docker 20.10+
- Python 3.11+
- Make

### –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫:
```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
git clone https://github.com/jalm/core-runner.git
cd core-runner

# –ü–æ–ª–Ω–∞—è —Å–±–æ—Ä–∫–∞ —è–¥—Ä–∞
make kernel

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
make dev_run

# –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ
make deploy_local
```

## üìã –≠—Ç–∞–ø—ã —Å–±–æ—Ä–∫–∏ (Core Spec)

### –≠—Ç–∞–ø 1: –í—ã—á–ª–µ–Ω–µ–Ω–∏–µ –∞—Ç–æ–º–æ–≤ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
```bash
make kernel_raw
```
- –°–æ–∑–¥–∞—ë—Ç `kernel/raw_atomics.csv`
- 47 –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏

### –≠—Ç–∞–ø 2: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∞—Ç–æ–º–æ–≤ –≤ —Å–ª–æ–∏
```bash
make kernel_group
```
- –°–æ–∑–¥–∞—ë—Ç `kernel/layers.json`
- 6 —Å–ª–æ—ë–≤ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏

### –≠—Ç–∞–ø 3: –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —à–∞–≥–∏-–∫–∞—Ä—Ç–æ—á–∫–∏
```bash
make kernel_cards
```
- –°–æ–∑–¥–∞—ë—Ç `kernel/step_cards/*.yml`
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

### –≠—Ç–∞–ø 4: –ü–æ–∏—Å–∫ –≥–æ—Ç–æ–≤—ã—Ö –¥–≤–∏–∂–∫–æ–≤
```bash
make search_isolate
```
- –ó–∞–ø—É—Å–∫–∞–µ—Ç `scripts/search_micro_isolates.py`
- –°–æ–∑–¥–∞—ë—Ç `candidates/isolates.json`

### –≠—Ç–∞–ø 5: –°–±–æ—Ä–∫–∞ —è–¥—Ä–∞
```bash
make kernel_build
```
- –°–æ–±–∏—Ä–∞–µ—Ç Docker-–æ–±—Ä–∞–∑ `jalm/core-runner:VERSION`
- –ú–Ω–æ–≥–æ—Å—Ç–∞–¥–∏–π–Ω–∞—è —Å–±–æ—Ä–∫–∞ —Å musl-runtime

### –≠—Ç–∞–ø 6: –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ registry
```bash
make kernel_push
```
- –ü—É–±–ª–∏–∫—É–µ—Ç –≤ `ghcr.io/jalm/core-runner:latest`
- –°–æ–∑–¥–∞—ë—Ç `catalog/core-runner.engine.json`

## üîß API Endpoints

### –û—Å–Ω–æ–≤–Ω—ã–µ endpoints:
- `GET /` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ
- `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
- `POST /exec` - –ó–∞–ø—É—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è JALM
- `GET /exec/{execution_id}` - –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `GET /exec` - –°–ø–∏—Å–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```bash
# –ó–∞–ø—É—Å–∫ JALM-–∫–æ–Ω—Ñ–∏–≥–∞
curl -X POST http://localhost:8888/exec \
  -H "Content-Type: application/json" \
  -d '{
    "jalm_config": {
      "intent": "test_execution",
      "steps": [
        {
          "id": "http_request",
          "layer": "io-http",
          "input": {
            "method": "GET",
            "url": "https://httpbin.org/json"
          }
        }
      ]
    }
  }'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
curl http://localhost:8888/exec/{execution_id}
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ò–∑–æ–ª—è—Ü–∏—è:
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è —Å Docker
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `jalm:jalm` –±–µ–∑ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
- Readonly —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (–∫—Ä–æ–º–µ /data, /tmp)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ (CPU, –ø–∞–º—è—Ç—å)

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- Structured logging
- Health checks
- Metrics endpoint
- Execution tracing

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- **–†–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞**: ~150MB
- **–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞**: <2 —Å–µ–∫—É–Ω–¥—ã
- **–ü–∞–º—è—Ç—å**: 512MB (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **CPU**: 1 core (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏**: Python, JavaScript, TypeScript, Go, Rust

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –ú–Ω–æ–≥–æ—Å—Ç–∞–¥–∏–π–Ω–∞—è —Å–±–æ—Ä–∫–∞ Docker
- Alpine Linux base image
- Musl runtime
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ JALM:
1. **–ü—Ä–∏—ë–º –∫–æ–Ω—Ñ–∏–≥–∞** - –í–∞–ª–∏–¥–∞—Ü–∏—è JALM-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
2. **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –†–∞–∑–±–æ—Ä –Ω–∞ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ —à–∞–≥–∏
3. **–ò–∑–æ–ª—è—Ü–∏—è** - –ó–∞–ø—É—Å–∫ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Å—Ä–µ–¥–µ
4. **–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ** - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ —Å–ª–æ—è–º
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
6. **–†–µ–∑—É–ª—å—Ç–∞—Ç** - –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤/–æ—à–∏–±–æ–∫

### –°–æ—Å—Ç–æ—è–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- `pending` - –û–∂–∏–¥–∞–µ—Ç –∑–∞–ø—É—Å–∫–∞
- `running` - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- `completed` - –£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- `failed` - –ó–∞–≤–µ—Ä—à–µ–Ω–æ —Å –æ—à–∏–±–∫–æ–π

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
make dev_setup
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
make dev_test
```

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞:
```bash
make kernel_build
```

### –û—á–∏—Å—Ç–∫–∞:
```bash
make kernel_clean
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **API Docs**: http://localhost:8888/docs
- **ReDoc**: http://localhost:8888/redoc
- **GitHub**: https://github.com/jalm/core-runner

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
3. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã
5. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE)

## üîó –°—Å—ã–ª–∫–∏

- [JALM Full Stack](https://github.com/jalm/jalm-stack)
- [Core Spec](../core_spec)
- [Tula Spec](../tula_spec)
- [Shablon Spec](../shablon_spec) 