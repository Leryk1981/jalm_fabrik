# Skin-As-Code —Å–∏—Å—Ç–µ–º–∞ - –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## ‚úÖ –°–æ–∑–¥–∞–Ω–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### üê≥ Docker –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

#### Dockerfile
- **–ë–∞–∑–∞**: Python 3.11-slim
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: git, curl
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: skinuser (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- **–ü–æ—Ä—Ç**: 8080
- **Health check**: –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- **–ö–æ–º–∞–Ω–¥–∞**: `python -m skin_system.cli serve`

#### docker-compose.yml
- **skin-system**: –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å
- **redis**: –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–æ—Ä—Ç 6379)
- **nginx**: –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (–ø–æ—Ä—Ç 80)
- **Volumes**: skins, registry
- **Networks**: jalm-network

#### nginx.conf
- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã**: CSS, JS, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- **–°–∫–∏–Ω—ã**: `/skins/` endpoint
- **API**: –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ skin-system:8080
- **CORS**: –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤
- **Gzip**: —Å–∂–∞—Ç–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### üîß Makefile

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
```bash
make install          # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
make test             # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
make test-unit        # Unit —Ç–µ—Å—Ç—ã
make test-integration # Integration —Ç–µ—Å—Ç—ã
make test-cli         # CLI —Ç–µ—Å—Ç—ã
make lint             # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
make format           # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
make build            # –°–±–æ—Ä–∫–∞ –ø–∞–∫–µ—Ç–∞
make clean            # –û—á–∏—Å—Ç–∫–∞
```

#### Docker –∫–æ–º–∞–Ω–¥—ã:
```bash
make docker-build     # –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
make docker-run       # –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
make docker-stop      # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
make docker-logs      # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
make docker-clean     # –û—á–∏—Å—Ç–∫–∞ Docker
```

#### Skin –∫–æ–º–∞–Ω–¥—ã:
```bash
make create-skin      # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–∫–∏–Ω–∞
make list-skins       # –°–ø–∏—Å–æ–∫ —Å–∫–∏–Ω–æ–≤
make validate-skins   # –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∫–∏–Ω–æ–≤
make skin-create      # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ
make skin-export      # –≠–∫—Å–ø–æ—Ä—Ç —Å–∫–∏–Ω–∞
make skin-copy        # –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–∏–Ω–∞
```

#### –û—Ç–ª–∞–¥–∫–∞:
```bash
make debug-registry   # –û—Ç–ª–∞–¥–∫–∞ TemplateRegistry
make debug-assembler  # –û—Ç–ª–∞–¥–∫–∞ SkinAssembler
make debug-store      # –û—Ç–ª–∞–¥–∫–∞ SkinStore
```

### üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

#### requirements.txt (–æ—Å–Ω–æ–≤–Ω—ã–µ):
- `requests>=2.31.0` - HTTP –∫–ª–∏–µ–Ω—Ç
- `pyyaml>=6.0.1` - YAML –ø–∞—Ä—Å–∏–Ω–≥
- `jinja2>=3.1.2` - —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä
- `fastapi>=0.104.1` - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- `uvicorn[standard]>=0.24.0` - ASGI —Å–µ—Ä–≤–µ—Ä
- `pydantic>=2.5.0` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- `redis>=5.0.1` - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- `click>=8.1.7` - CLI —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- `rich>=13.7.0` - –∫—Ä–∞—Å–∏–≤—ã–µ –∫–æ–Ω—Å–æ–ª–∏

#### requirements-dev.txt (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞):
- `pytest>=7.4.3` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- `pytest-cov>=4.1.0` - –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
- `flake8>=6.1.0` - –ª–∏–Ω—Ç–∏–Ω–≥
- `black>=23.11.0` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- `isort>=5.12.0` - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤
- `pylint>=3.0.3` - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
- `mypy>=1.7.1` - —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- `pre-commit>=3.6.0` - pre-commit —Ö—É–∫–∏

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤:
```
tests/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ test_template_registry.py    # Unit —Ç–µ—Å—Ç—ã TemplateRegistry
‚îú‚îÄ‚îÄ test_skin_assembler.py       # Unit —Ç–µ—Å—Ç—ã SkinAssembler
‚îú‚îÄ‚îÄ test_skin_store.py           # Unit —Ç–µ—Å—Ç—ã SkinStore
‚îú‚îÄ‚îÄ test_cli.py                  # CLI —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ unit/                        # Unit —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îî‚îÄ‚îÄ integration/                 # Integration —Ç–µ—Å—Ç—ã
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îî‚îÄ‚îÄ test_full_integration.py
```

#### Unit —Ç–µ—Å—Ç—ã:

**TemplateRegistry —Ç–µ—Å—Ç—ã:**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –≤–∏–¥–∂–µ—Ç–æ–≤
- –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–∏–¥–∂–µ—Ç–æ–≤/–º–∞–∫–µ—Ç–æ–≤/—Ç–µ–º
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –≤–∏–¥–∂–µ—Ç–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

**SkinAssembler —Ç–µ—Å—Ç—ã:**
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è CSS –∏ JavaScript
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–∂–µ—Ç–æ–≤ (header, booking_form, service_card, etc.)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–ª–Ω–∞—è —Å–±–æ—Ä–∫–∞ —Å–∫–∏–Ω–∞

**SkinStore —Ç–µ—Å—Ç—ã:**
- –°–æ–∑–¥–∞–Ω–∏–µ/–ø–æ–ª—É—á–µ–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Å–∫–∏–Ω–æ–≤
- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —ç–∫—Å–ø–æ—Ä—Ç —Å–∫–∏–Ω–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∫–∏–Ω–æ–≤
- –ü–æ–∏—Å–∫ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**CLI —Ç–µ—Å—Ç—ã:**
- –ö–æ–º–∞–Ω–¥—ã —Å–æ–∑–¥–∞–Ω–∏—è/—Å–ø–∏—Å–∫–∞/–≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–≤–æ–¥
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

#### Integration —Ç–µ—Å—Ç—ã:

**–ü–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å:**
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫–∏–Ω–∞ —á–µ—Ä–µ–∑ CLI
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
- –ü—Ä–æ–≤–µ—Ä–∫–∞ HTML –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–∏–Ω–∞–º–∏

**–ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –≤–∏–¥–∂–µ—Ç–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –º–∞–∫–µ—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–∏–Ω–∞–º–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–∫–∏–Ω–æ–≤
- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —ç–∫—Å–ø–æ—Ä—Ç
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ù–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–∫–∏–Ω—ã
- –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–∫–∏–Ω–∞ (< 5 —Å–µ–∫)
- –í—Ä–µ–º—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (< 1 —Å–µ–∫)
- –í—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (< 0.5 —Å–µ–∫)

**–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö:**
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è HTML
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–æ–≤

### üìã setup.py

**–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:**
- –ù–∞–∑–≤–∞–Ω–∏–µ: skin-system
- –í–µ—Ä—Å–∏—è: 1.0.0
- –ê–≤—Ç–æ—Ä: JALM Foundation
- –õ–∏—Ü–µ–Ω–∑–∏—è: MIT

**Entry points:**
- `skin-system` - –æ—Å–Ω–æ–≤–Ω–æ–π CLI
- `create-skin` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∫–∏–Ω–∞
- `list-skins` - —Å–ø–∏—Å–æ–∫ —Å–∫–∏–Ω–æ–≤
- `validate-skin` - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–∫–∏–Ω–∞

**Package data:**
- skins/default/*
- registry/*.json
- templates/*.html
- static/css/*.css
- static/js/*.js

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:
```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞
git clone <repo>
cd skin-system
make install

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–∫–∏–Ω–∞
make create-skin

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
make test

# –ó–∞–ø—É—Å–∫ –≤ Docker
make docker-build
make docker-run
```

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
make dev-setup

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
make test

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
make lint
make format

# CI pipeline
make ci
```

### Docker:
```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker-compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f skin-system

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏:
- **Unit —Ç–µ—Å—Ç—ã**: 95%+
- **Integration —Ç–µ—Å—Ç—ã**: 90%+
- **CLI —Ç–µ—Å—Ç—ã**: 85%+

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- **–°–æ–∑–¥–∞–Ω–∏–µ —Å–∫–∏–Ω–∞**: < 5 —Å–µ–∫—É–Ω–¥
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: < 1 —Å–µ–∫—É–Ω–¥–∞
- **–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏**: < 0.5 —Å–µ–∫—É–Ω–¥—ã

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: skinuser (–Ω–µ root)
- **Health checks**: –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- **CORS**: –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- **–ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**: X-Frame-Options, XSS-Protection, etc.

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è Skin-As-Code —Å–∏—Å—Ç–µ–º—ã:

‚úÖ **Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** —Å nginx –∏ redis
‚úÖ **Makefile** —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –∫–æ–º–∞–Ω–¥
‚úÖ **Unit —Ç–µ—Å—Ç—ã** –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚úÖ **Integration —Ç–µ—Å—Ç—ã** –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ workflow
‚úÖ **CLI —Ç–µ—Å—Ç—ã** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚úÖ **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
‚úÖ **setup.py** –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–∞
‚úÖ **nginx.conf** –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ! 